<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" rel="stylesheet">
  <title>Link Generator</title>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</head>

<body class="p-3 m-0 border-0 bd-example m-0 border-0">

  <h1 style="text-align: center;">Link Generator</h1>
  <h5 style="text-align: center;">The tool to help you generate the add-in link. Please try out!</h5>
  <br>
  <div class="container text-left">
    <div class="row">
      <div class="col">
        <div class="input-group">
          <span class="input-group-text" id="inputGroup-addin-id"><strong>Add-in ID</strong></span>
          <input id="input-addin-id" type="text" class="form-control" aria-label="Sizing example input"
            aria-describedby="inputGroup-sizing-default">
        </div>
      </div>
      <div class="col">
        <small style="font-style: italic;">
          The unique add-in ID. For example, "WA104380862".
        </small>
      </div>
    </div>
    <br>
    <div class="row">
      <div class="col">
        <div class="input-group mb-3">
          <span class="input-group-text" id="inputGroup-addin-name"><strong>Add-in name</strong></span>
          <input id="input-addin-name" type="text" class="form-control" aria-label="Sizing example input"
            aria-describedby="inputGroup-sizing-default">
        </div>
      </div>
      <div class="col">
        <small style="font-style: italic;">
          You can get the correct add-in name by following below steps.
          <br>
          1. Go to
          <a href="https://appsource.microsoft.com/en-US/" target="_blank"
            rel="noopener noreferrer nofollow">https://appsource.microsoft.com/en-US/</a>
          from your browser.
          <br>
          2. Input your add-in ID the search box and get results.
          <br>
          3. Copy the add-in name which is below your add-in icon, and paste it here without any change.
          <br>
          For example, if the search result page is
          <a href="https://appsource.microsoft.com/en-US/marketplace/apps?search=WA104380862&page=1" target="_blank"
            rel="noopener noreferrer nofollow">this</a>
          , then the add-in name is "Script Lab, a Microsoft Garage project".
        </small>
      </div>
    </div>
  </div>
  <div class="container text-left">
    <div class="row">
      <div class="col">
        <div><strong>Supported products</strong></div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" value="" id="flexCheckWord">
          <label class="form-check-label" for="flexCheckDefault">
            Word on the Web
          </label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" value="" id="flexCheckExcel">
          <label class="form-check-label" for="flexCheckDefault">
            Excel on the Web
          </label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" value="" id="flexCheckPowerPoint">
          <label class="form-check-label" for="flexCheckDefault">
            PowerPoint on the Web
          </label>
        </div>
      </div>
    </div>
  </div>

  <br>

  <div class="container text-left">
    <div class="row">
      <div class="col">
        <button id="get-url" type="button" class="btn btn-primary" onclick="getUrl()">Get the Link</button>
        <hr>
        <h6>The links generated for your add-in:</h6>
        <p id="links"></p>

      </div>
    </div>
  </div>

  <script>
    function getUrl() {
      var addinId = document.getElementById("input-addin-id").value;
      var addinName = document.getElementById("input-addin-name").value;

      if (addinId == "") {
        alert("Please input the add-in ID!");
        return;
      }

      if (addinName == "") {
        alert("Please input the add-in name!");
        return;
      }

      if (document.getElementById("flexCheckWord").checked == false && document.getElementById("flexCheckExcel").checked == false && document.getElementById("flexCheckPowerPoint").checked == false) {
        alert("Please select the supported products!");
        return;
      }

      document.getElementById("links").innerHTML = "";

      if (document.getElementById("flexCheckWord").checked) {
        var linkWord = 'https://go.microsoft.com/fwlink/?linkid=2261098&templateid='.concat(addinId,
          '&templatetitle=',
          addinName);

        document.getElementById("links").innerHTML = document.getElementById("links").innerHTML.concat(
          '<p>Word on the web: ',
          '<a href="', linkWord, '" target="_blank" rel="noopener noreferrer">',
          linkWord,
          '</a>',
          '</p>'
        );
      }

      if (document.getElementById("flexCheckExcel").checked) {
        var linkExcel = 'https://go.microsoft.com/fwlink/?linkid=2261819&templateid='.concat(addinId,
          '&templatetitle=',
          addinName);

        document.getElementById("links").innerHTML = document.getElementById("links").innerHTML.concat(
          '<p>Excel on the web: ',
          '<a href="', linkExcel, '" target="_blank" rel="noopener noreferrer">',
          linkExcel,
          '</a>',
          '</p>'
        );
      }

      if (document.getElementById("flexCheckPowerPoint").checked) {
        var linkPowerPoint = 'https://go.microsoft.com/fwlink/?linkid=2261820&templateid='.concat(addinId,
          '&templatetitle=',
          addinName);

        document.getElementById("links").innerHTML = document.getElementById("links").innerHTML.concat(
          '<p>PowerPoint on the web: ',
          '<a href="', linkPowerPoint, '" target="_blank" rel="noopener noreferrer">',
          linkPowerPoint,
          '</a>',
          '</p>'
        );
      }

    }
  </script>

</body>

</html>